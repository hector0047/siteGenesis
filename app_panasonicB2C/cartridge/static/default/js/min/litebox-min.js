!function($,e,t,o){function i(e,t){this.element=e,this.$element=$(this.element),this.options=$.extend({},r,t),this._defaults=r,this._name=a,this.init()}function n(){return e.innerHeight?e.innerHeight:$(e).height()}function l(e){$(e).each(function(){var e=new Image;e.src=this,e.width>0&&$("<img />").attr("src",this).addClass("litebox-preload").appendTo("body").hide()})}var a="liteBox",r={revealSpeed:400,background:"rgba(0,0,0,.8)",overlayClose:!0,escKey:!0,navKey:!0,closeTip:"tip-l-fade",closeTipText:"Close",prevTip:"tip-t-fade",prevTipText:"Previous",nextTip:"tip-t-fade",nextTipText:"Next",callbackInit:function(){},callbackBeforeOpen:function(){},callbackAfterOpen:function(){},callbackBeforeClose:function(){},callbackAfterClose:function(){},callbackError:function(){},callbackPrev:function(){},callbackNext:function(){},errorMessage:"Error loading content."};i.prototype={init:function(){var e=this;this.$element.on("click",function(t){t.preventDefault(),e.openLitebox()}),keyEsc=27,keyLeft=37,keyRight=39,$("body").off("keyup").on("keyup",function(t){e.options.escKey&&t.keyCode==keyEsc&&e.closeLitebox(),e.options.navKey&&t.keyCode==keyLeft&&$(".litebox-prev").trigger("click"),e.options.navKey&&t.keyCode==keyRight&&$(".litebox-next").trigger("click")}),this.options.callbackInit.call(this)},openLitebox:function(){var e=this;this.options.callbackBeforeOpen.call(this),e.buildLitebox();var t=this.$element;if(e.populateLitebox(t),e.options.overlayClose&&$litebox.on("click",function(t){(t.target===this||$(t.target).hasClass("litebox-container")||$(t.target).hasClass("litebox-error"))&&e.closeLitebox()}),$close.on("click",function(){e.closeLitebox()}),this.$element.attr("data-litebox-group")){var e=this,o=this.$element.attr("data-litebox-group"),i=$('[data-litebox-group="'+this.$element.attr("data-litebox-group")+'"]'),n=[];$('[data-litebox-group="'+o+'"]').each(function(){var e=$(this).attr("href");n.push(e)}),l(n),$(".litebox-nav").show(),$prevNav.off("click").on("click",function(){e.options.callbackPrev.call(this);var o=i.index(t);t=i.eq(o-1),$(t).length||(t=i.last()),e.populateLitebox(t)}),$nextNav.off("click").on("click",function(){e.options.callbackNext.call(this);var o=i.index(t);t=i.eq(o+1),$(t).length||(t=i.first()),e.populateLitebox(t)})}this.options.callbackAfterOpen.call(this)},buildLitebox:function(){var e=this;$litebox=$("<div>",{"class":"litebox-overlay"}),$close=$("<div>",{"class":"litebox-close "+this.options.closeTip,"data-tooltip":this.options.closeTipText}),$text=$("<div>",{"class":"litebox-text"}),$error=$('<div class="litebox-error"><span>'+this.options.errorMessage+"</span></div>"),$prevNav=$("<div>",{"class":"litebox-nav litebox-prev "+this.options.prevTip,"data-tooltip":this.options.prevTipText}),$nextNav=$("<div>",{"class":"litebox-nav litebox-next "+this.options.nextTip,"data-tooltip":this.options.nextTipText}),$container=$("<div>",{"class":"litebox-container"}),$loader=$("<div>",{"class":"litebox-loader"}),$("body").prepend($litebox.css({"background-color":this.options.background})),$litebox.append($close,$text,$prevNav,$nextNav,$container),$litebox.fadeIn(this.options.revealSpeed)},populateLitebox:function(e){var t=this,o=e.attr("href"),i=$(".litebox-content");$litebox.append($loader);var n=e.attr("data-litebox-text");if("undefined"==typeof n||""==n?($(".litebox-text").removeClass("active"),$(".litebox-text").html()):($(".litebox-text").html(n),$(".litebox-text").addClass("active")),null!==o.match(/\.(jpeg|jpg|gif|png|bmp)/i)){var l=$("<img>",{src:o,"class":"litebox-content"});t.transitionContent("image",i,l),$("img.litebox-content").imagesLoaded(function(){$loader.remove()}),l.error(function(){t.liteboxError(),$loader.remove()})}else if(videoURL=o.match(/(youtube|youtu|vimeo|dailymotion|kickstarter)\.(com|be)\/((watch\?v=([-\w]+))|(video\/([-\w]+))|(projects\/([-\w]+)\/([-\w]+))|([-\w]+))/)){var a="";if("youtube"==videoURL[1]&&(a="http://www.youtube.com/v/"+videoURL[5]),"youtu"==videoURL[1]&&(a="http://www.youtube.com/v/"+videoURL[3]),"vimeo"==videoURL[1]&&(a="http://player.vimeo.com/video/"+videoURL[3]),"dailymotion"==videoURL[1]&&(a="https://www.dailymotion.com/embed/video/"+videoURL[7]),"kickstarter"==videoURL[1]&&(a="https://www.kickstarter.com/projects/"+videoURL[9]+"/"+videoURL[10]+"/widget/video.html"),a){var r=$("<iframe>",{src:a,frameborder:"0",vspace:"0",hspace:"0",scrolling:"no",allowfullscreen:"","class":"litebox-content",style:"background: #000"});t.transitionContent("embed",i,r),r.load(function(){$loader.remove()})}}else if("#"==o.substring(0,1))$(o).length?($html=$("<div>",{"class":"litebox-content litebox-inline-html"}),$html.append($(o).clone()),t.transitionContent("inline",i,$html)):t.liteboxError(),$loader.remove();else{var r=$("<iframe>",{src:o,frameborder:"0",vspace:"0",hspace:"0",scrolling:"auto","class":"litebox-content",allowfullscreen:""});t.transitionContent("iframe",i,r),r.load(function(){$loader.remove()})}},transitionContent:function(t,o,i){var n=this;"inline"!=t&&$container.removeClass("litebox-scroll"),o.remove(),$container.append(i),"inline"==t&&$container.addClass("litebox-scroll"),n.centerContent(),$(e).on("resize",function(){n.centerContent()})},centerContent:function(){$litebox.css({height:n()}),$container.css({"line-height":$container.height()+"px"}),"undefined"!=typeof $html&&$(".litebox-inline-html").outerHeight()<$container.height()&&$(".litebox-inline-html").css({"margin-top":"-"+$(".litebox-inline-html").outerHeight()/2+"px",top:"50%"})},closeLitebox:function(){this.options.callbackBeforeClose.call(this),$litebox.fadeOut(this.options.revealSpeed,function(){$(".litebox-nav").hide(),$litebox.empty().remove(),$(".litebox-preload").remove()}),$(".tipsy").fadeOut(this.options.revealSpeed,function(){$(this).remove()}),$(".litebox-prev").off("click"),$(".litebox-next").off("click"),this.options.callbackAfterClose.call(this)},liteboxError:function(){this.options.callbackError.call(this),$container.append($error)}},$.fn[a]=function(e){return this.each(function(){$.data(this,a)||$.data(this,a,new i(this,e))})}}(jQuery,window,document);